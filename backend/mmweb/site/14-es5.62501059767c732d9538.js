function _defineProperties(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"7H8U":function(t,e,n){"use strict";n.r(e);var a=n("ofXK"),r=n("tyNb"),o=n("fXoL"),i=n("lWTH");function s(t,e){1&t&&o["\u0275\u0275element"](0,"router-outlet")}var l,c,d=function(){return["view","solar"]},u=((l=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||l)},l.\u0275cmp=o["\u0275\u0275defineComponent"]({type:l,selectors:[["ngx-solar"]],decls:1,vars:2,consts:[[4,"nbIsGranted"]],template:function(t,e){1&t&&o["\u0275\u0275template"](0,s,1,0,"router-outlet",0),2&t&&o["\u0275\u0275property"]("nbIsGranted",o["\u0275\u0275pureFunction0"](1,d))},directives:[i.b,r.h],encapsulation:2}),l),h=n("tk/3"),f=n("LRne"),p=n("lJxs"),m=n("JIr8"),v=n("aceb"),g={headers:new h.d({"Content-Type":"application/json"})},b="https://solmm01.fmg.local/api/solar/",y=((c=function(){function t(e,n){_classCallCheck(this,t),this.http=e,this.toastrService=n}return _createClass(t,[{key:"extractData",value:function(t){return t||{}}},{key:"handleError",value:function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1?arguments[1]:void 0);return function(n){return t.dangerToast("top-right","danger",n.statusText,n.status),Object(f.a)(e)}}},{key:"returnFalse",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=arguments.length>1?arguments[1]:void 0;return Object(f.a)(t)}},{key:"createSolarController",value:function(t){return this.http.post(b+"create",JSON.stringify(t),g).pipe(Object(p.a)(this.extractData),Object(m.a)(this.handleError("error")))}},{key:"updateSolarController",value:function(t){return this.http.post(b+"update",JSON.stringify(t),g).pipe(Object(p.a)(this.extractData),Object(m.a)(this.handleError("error")))}},{key:"deleteSolarController",value:function(t){return this.http.delete(b+"delete/"+t).pipe(Object(p.a)(this.extractData),Object(m.a)(this.handleError("failed")))}},{key:"getSolarControllers",value:function(){return this.http.get(b+"controllers").pipe(Object(p.a)(this.extractData),Object(m.a)(this.handleError("failed")))}},{key:"getSolarData",value:function(){return this.http.get(b+"data").pipe(Object(p.a)(this.extractData),Object(m.a)(this.handleError("failed")))}},{key:"dangerToast",value:function(t,e,n,a){var r=this;this.toastRef=this.toastrService.show("API call error - "+a+": "+n,"Failed",{position:t,status:e,preventDuplicates:!0,duration:0}),this.toastRef&&(this.tempToast=this.toastRef),this.delay&&clearTimeout(this.delay),this.delay=setTimeout((function(){r.clearToast(r.tempToast)}),5500)}},{key:"successToast",value:function(t,e,n,a){this.toastrService.show("API call error - "+a+": "+n,"Failed",{position:t,status:e,preventDuplicates:!0})}},{key:"clearToast",value:function(t){t&&t.close()}}]),t}()).\u0275fac=function(t){return new(t||c)(o["\u0275\u0275inject"](h.a),o["\u0275\u0275inject"](v.ob))},c.\u0275prov=o["\u0275\u0275defineInjectable"]({token:c,factory:c.\u0275fac,providedIn:"root"}),c),C=n("eGx+");function w(t,e){if(1&t&&(o["\u0275\u0275elementStart"](0,"div",4),o["\u0275\u0275elementStart"](1,"nb-card"),o["\u0275\u0275elementStart"](2,"nb-card-header"),o["\u0275\u0275text"](3),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](4,"nb-card-body"),o["\u0275\u0275element"](5,"ngx-solar-doughnut",5),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](6,"nb-card-footer"),o["\u0275\u0275text"](7),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()),2&t){var n=e.$implicit;o["\u0275\u0275advance"](3),o["\u0275\u0275textInterpolate1"](" ",n.name," "),o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("data",n),o["\u0275\u0275advance"](2),o["\u0275\u0275textInterpolate1"](" State: ",n.live.charge_state," ")}}function S(t,e){if(1&t&&(o["\u0275\u0275elementStart"](0,"div",2),o["\u0275\u0275template"](1,w,8,3,"div",3),o["\u0275\u0275elementEnd"]()),2&t){var n=o["\u0275\u0275nextContext"](2);o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngForOf",n.solar_datas)}}var E=function(){return["view","solar_controllers"]};function T(t,e){1&t&&(o["\u0275\u0275elementStart"](0,"div"),o["\u0275\u0275template"](1,S,2,1,"div",1),o["\u0275\u0275elementEnd"]()),2&t&&(o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("nbIsGranted",o["\u0275\u0275pureFunction0"](1,E)))}var k,x=((k=function(){function t(e){_classCallCheck(this,t),this.solar=e,this.loaded=!1}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.refreshData(),this.loaded=!0,this.interval=setInterval((function(){t.refreshData()}),1e4)}},{key:"ngOnDestroy",value:function(){clearInterval(this.interval)}},{key:"refreshData",value:function(){var t=this;this.solar.getSolarData().subscribe((function(e){t.solar_datas=e}))}}]),t}()).\u0275fac=function(t){return new(t||k)(o["\u0275\u0275directiveInject"](y))},k.\u0275cmp=o["\u0275\u0275defineComponent"]({type:k,selectors:[["solar-controllers"]],decls:1,vars:1,consts:[[4,"ngIf"],["class","row",4,"nbIsGranted"],[1,"row"],["class","col-xl-2 col-lg-3 col-md-4 col-sm-6",4,"ngFor","ngForOf"],[1,"col-xl-2","col-lg-3","col-md-4","col-sm-6"],[3,"data"]],template:function(t,e){1&t&&o["\u0275\u0275template"](0,T,2,2,"div",0),2&t&&o["\u0275\u0275property"]("ngIf",e.loaded)},directives:[a.m,i.b,a.l,v.n,v.p,v.m,C.a,v.o],styles:["nb-card[_ngcontent-%COMP%]{height:250px}"]}),k),D=n("RS3s");function O(t,e){if(1&t){var n=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"ng2-smart-table",2),o["\u0275\u0275listener"]("deleteConfirm",(function(t){o["\u0275\u0275restoreView"](n);var e=o["\u0275\u0275nextContext"](),a=o["\u0275\u0275reference"](2);return e.onDialog(a,"delete",t)}))("editConfirm",(function(t){o["\u0275\u0275restoreView"](n);var e=o["\u0275\u0275nextContext"](),a=o["\u0275\u0275reference"](2);return e.onDialog(a,"edit",t)}))("createConfirm",(function(t){o["\u0275\u0275restoreView"](n);var e=o["\u0275\u0275nextContext"](),a=o["\u0275\u0275reference"](2);return e.onDialog(a,"create",t)})),o["\u0275\u0275elementEnd"]()}if(2&t){var a=o["\u0275\u0275nextContext"]();o["\u0275\u0275property"]("settings",a.controllerSettings)("source",a.controllerSource)}}function I(t,e){if(1&t){var n=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"nb-card",3),o["\u0275\u0275elementStart"](1,"nb-card-header"),o["\u0275\u0275text"](2,"Warning"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](3,"nb-card-body"),o["\u0275\u0275text"](4),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](5,"nb-card-footer"),o["\u0275\u0275elementStart"](6,"div",4),o["\u0275\u0275elementStart"](7,"button",5),o["\u0275\u0275listener"]("click",(function(){o["\u0275\u0275restoreView"](n);var t=e.dialogRef;return o["\u0275\u0275nextContext"]().onModifyConfirm(!0),t.close()})),o["\u0275\u0275text"](8,"Yes"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275text"](9," \xa0\xa0 "),o["\u0275\u0275elementStart"](10,"button",5),o["\u0275\u0275listener"]("click",(function(){o["\u0275\u0275restoreView"](n);var t=e.dialogRef;return o["\u0275\u0275nextContext"]().onModifyConfirm(!1),t.close()})),o["\u0275\u0275text"](11,"No"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()}if(2&t){var a=e.$implicit;o["\u0275\u0275advance"](4),o["\u0275\u0275textInterpolate"](a)}}var P,_,j=function(){return["view","solar_edit"]},M=[{path:"",component:u,children:[{path:"controllers",component:x},{path:"edit",component:(P=function(){function t(e,n,a){_classCallCheck(this,t),this.solar=e,this.dialogService=n,this.toastrService=a,this.submitted=!1,this.models=[{title:"Tristar-60 MPPT",value:"Tristar-60 MPPT"},{title:"Tristar MPPT 600V",value:"Tristar MPPT 600V"}],this.controllerSettings={add:{addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>',confirmCreate:!0}},this.index=0,this.ipPattern=new RegExp("(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)"),this.whiteSpace=new RegExp("([^\\s]*)")}return _createClass(t,[{key:"loadModuleTableSettings",value:function(){return{add:{addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>',confirmCreate:!0},edit:{editButtonContent:'<i class="nb-edit"></i>',saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>',confirmSave:!0},delete:{deleteButtonContent:'<i class="nb-trash"></i>',confirmDelete:!0},columns:{name:{title:"Name",type:"string"},location:{title:"Location",type:"string"},ip:{title:"IP",type:"string"},model:{title:"Model",type:"string",editor:{type:"list",config:{list:this.models}}},uid:{title:"UID",type:"text",editable:!1,editor:{type:"list",config:{list:[{value:"",title:"(auto)"}]}}}}}}},{key:"refreshData",value:function(){var t=this;this.solar.getSolarControllers().subscribe((function(e){t.controllerSource=e,t.controllerSettings=t.loadModuleTableSettings()}))}},{key:"ngOnDestroy",value:function(){}},{key:"ngOnInit",value:function(){this.refreshData()}},{key:"onDialog",value:function(t,e,n){this.tableEvent=n,this.modifyType=e,this.dialogMessage="create"==e?"Are you sure you want to "+e+" "+this.tableEvent.newData.name+"?":"Are you sure you want to "+e+" "+this.tableEvent.data.name+"?",this.dialogService.open(t,{context:this.dialogMessage})}},{key:"onModifyConfirm",value:function(t){var e=this,n=!1;t?"delete"==this.modifyType?this.solar.deleteSolarController(this.tableEvent.data.uid).subscribe((function(t){e.postResult=t,e.postResult.success?(e.successToast("top-right","success",e.postResult.message),e.tableEvent.confirm.resolve(),e.refreshData()):(e.dangerToast("top-right","danger",e.postResult.message),e.tableEvent.confirm.reject())})):"edit"==this.modifyType?(0==this.ipPattern.test(this.tableEvent.newData.ip)&&(this.dangerToast("top-right","danger","IP Address invalid."),n=!0),""===this.tableEvent.newData.name&&(this.dangerToast("top-right","danger","Name invalid."),n=!0),""===this.tableEvent.newData.location&&(this.dangerToast("top-right","danger","Location invalid."),n=!0),""===this.tableEvent.newData.model&&(this.dangerToast("top-right","danger","Model invalid."),n=!0),0==n&&this.solar.updateSolarController(this.tableEvent.newData).subscribe((function(t){e.postResult=t,e.postResult.success?(e.successToast("top-right","success",e.postResult.message),e.tableEvent.confirm.resolve(),e.refreshData()):(e.dangerToast("top-right","danger",e.postResult.message),e.tableEvent.confirm.reject())}))):"create"==this.modifyType&&(0==this.ipPattern.test(this.tableEvent.newData.ip)&&(this.dangerToast("top-right","danger","IP Address invalid."),n=!0),""===this.tableEvent.newData.name&&(this.dangerToast("top-right","danger","Name invalid."),n=!0),""===this.tableEvent.newData.location&&(this.dangerToast("top-right","danger","Location invalid."),n=!0),""===this.tableEvent.newData.model&&(this.dangerToast("top-right","danger","Model invalid."),n=!0),0==n&&this.solar.createSolarController(this.tableEvent.newData).subscribe((function(t){e.postResult=t,e.postResult.success?(e.successToast("top-right","success",e.postResult.message),e.tableEvent.confirm.resolve(),e.refreshData()):(e.dangerToast("top-right","danger",e.postResult.message),e.tableEvent.confirm.reject())}))):this.tableEvent.confirm.reject()}},{key:"successToast",value:function(t,e,n){"delete"==this.modifyType?this.toastrService.show(n,"Success",{position:t,status:e}):"edit"==this.modifyType?this.toastrService.show(n,"Success",{position:t,status:e}):"create"==this.modifyType&&this.toastrService.show("Created  "+this.tableEvent.newData.name,"Success",{position:t,status:e})}},{key:"dangerToast",value:function(t,e,n){this.toastrService.show(n,"Error",{position:t,status:e})}}]),t}(),P.\u0275fac=function(t){return new(t||P)(o["\u0275\u0275directiveInject"](y),o["\u0275\u0275directiveInject"](v.z),o["\u0275\u0275directiveInject"](v.ob))},P.\u0275cmp=o["\u0275\u0275defineComponent"]({type:P,selectors:[["solar-edit"]],decls:3,vars:2,consts:[[3,"settings","source","deleteConfirm","editConfirm","createConfirm",4,"nbIsGranted"],["dialog",""],[3,"settings","source","deleteConfirm","editConfirm","createConfirm"],["status","danger"],[1,"wrapper"],["nbButton","",3,"click"]],template:function(t,e){1&t&&(o["\u0275\u0275template"](0,O,1,2,"ng2-smart-table",0),o["\u0275\u0275template"](1,I,12,1,"ng-template",null,1,o["\u0275\u0275templateRefExtractor"])),2&t&&o["\u0275\u0275property"]("nbIsGranted",o["\u0275\u0275pureFunction0"](1,j))},directives:[i.b,D.a,v.n,v.p,v.m,v.o,v.k],styles:[".nb-theme-corporate   [_nghost-%COMP%]   nb-card[_ngcontent-%COMP%], .nb-theme-cosmic   [_nghost-%COMP%]   nb-card[_ngcontent-%COMP%], .nb-theme-dark   [_nghost-%COMP%]   nb-card[_ngcontent-%COMP%], .nb-theme-default   [_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]{transform:translateZ(0)}.wrapper[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]     .ng-valid{color:#000}"]}),P)}]}],R=((_=function t(){_classCallCheck(this,t)}).\u0275mod=o["\u0275\u0275defineNgModule"]({type:_}),_.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||_)},imports:[[r.g.forChild(M)],r.g]}),_),B=n("h+2I");n.d(e,"SolarModule",(function(){return N}));var F,N=((F=function t(){_classCallCheck(this,t)}).\u0275mod=o["\u0275\u0275defineNgModule"]({type:F}),F.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||F)},imports:[[a.c,R,B.a,v.q,v.l,v.C,D.b,i.d]]}),F)}}]);